<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>atv4</title>
  <style>
    body {
      font-family: sans-serif; /*Fonte*/
      padding: 10px;
      border: 1px solid #ccc;
    }

    form {
      padding: 5px; /*Separa os items */  
      display: block;
    }

    label, input, span {
      display: inline-block;
      margin: 5px;
    }

    #totalItem1, #totalItem2, #totalItem3 { /*Subresultados*/
      background-color: #90ee90;
      padding: 5px 10px;
      border-radius: 4px;
      font-weight: bold;  
    }

    #totalFinal { /*Resultado final*/
      background-color: #87cefa; 
      padding: 5px 10px;
      border-radius: 4px;
      font-weight: bold; 
    }

  </style>
</head>
<body>
  <h3>Orçamento</h3>

  <form> <!--Item 1-->
    <label>Item:</label>
    <input type="text">

    <label>Valor:</label>
    <input type="number" id="valorItem1" step="0.01">

    <label>Quantidade:</label>
    <input type="number" id="quantidadeItem1">

    <span id="totalItem1">R$00.00</span>
  </form>  

  <form> <!--Item 2-->
    <label>Item:</label>
    <input type="text">

    <label>Valor:</label>
    <input type="number" id="valorItem2" step="0.01">

    <label>Quantidade:</label>
    <input type="number" id="quantidadeItem2">

    <span id="totalItem2">R$00.00</span>
  </form>  

  <form> <!--Item 3-->
    <label>Item:</label>
    <input type="text">

    <label>Valor:</label>
    <input type="number" id="valorItem3" step="0.01">

    <label>Quantidade:</label>
    <input type="number" id="quantidadeItem3">

    <span id="totalItem3">R$00.00</span>

  </form>  
    <span id="totalFinal">Valor total: R$ 00.00</span>
<script>
  //Calcula o subtotal de 1 item (valor * quantidade) e mostra o resultado no HTML
  function calcularSubtotal(idValor, idQuantidade, idResultado) {
    const valor = parseFloat(document.getElementById(idValor).value); //Pega o valor digitado no campo de valor (converte pra número real)
    const quantidade = parseInt(document.getElementById(idQuantidade).value);    //Pega a quantidade digitada (converte pra número inteiro)
    const total = valor * quantidade; 

    document.getElementById(idResultado).textContent = "R$ " + total.toFixed(2); //Mostra o total formatado com 2 casas decimais no campo correto
    calcularTotal();
  }

  
//Função simplificada que faz os subtotais de quantidade * valor
function calcularItem(numero) {
  let valor = parseFloat(document.querySelector("#valorItem" + numero).value) || 0;
  let quantidade = parseInt(document.querySelector("#quantidadeItem" + numero).value) || 0;
  return valor * quantidade;
}

  //Soma os totais dos 3 itens e mostra o valor final da compra
  function calcularTotal() {
    const total = calcularItem(1) + calcularItem(2) + calcularItem(3);
    document.querySelector("#totalFinal").textContent = "Valor total: R$ " + total.toFixed(2);
  }

  //Sempre que o valor ou quantidade mudar, atualiza subtotal e valor total 
  //Toda vez que alguém digitar ou alterar o valor no campo valorItem, chame a função calcularSubtotal() usando os ids dos campos envolvidos no cálculo do item 

  document.getElementById("valorItem1").addEventListener("input", () => calcularSubtotal("valorItem1", "quantidadeItem1", "totalItem1"));
  document.getElementById("quantidadeItem1").addEventListener("input", () => calcularSubtotal("valorItem1", "quantidadeItem1", "totalItem1"));

  document.getElementById("valorItem2").addEventListener("input", () => calcularSubtotal("valorItem2", "quantidadeItem2", "totalItem2"));
  document.getElementById("quantidadeItem2").addEventListener("input", () => calcularSubtotal("valorItem2", "quantidadeItem2", "totalItem2"));

  document.getElementById("valorItem3").addEventListener("input", () => calcularSubtotal("valorItem3", "quantidadeItem3", "totalItem3"));
  document.getElementById("quantidadeItem3").addEventListener("input", () => calcularSubtotal("valorItem3", "quantidadeItem3", "totalItem3"));
</script>

</body>
</html>
